<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cetak SO Prodsus - Auto Date</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --accent-color: #e94560;
            --success: #27ae60;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: var(--bg-color);
            color: white;
        }

        .header-title {
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        .menu-input {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .form-group { margin-bottom: 12px; }
        label { font-size: 12px; color: #aaa; display: block; margin-bottom: 5px; }
        
        select, input {
            width: 100%;
            padding: 10px;
            background: #0f3460;
            border: 1px solid #1f4068;
            color: white;
            border-radius: 6px;
            box-sizing: border-box;
        }

        .row-input { display: flex; gap: 10px; }
        .row-input .form-group { flex: 1; }

        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }
        .btn-save { background: var(--success); color: white; }
        .btn-print { background: var(--accent-color); color: white; }

        /* Struk Style */
        .struk-area {
            background: white;
            padding: 20px;
            border-radius: 4px;
            display: flex;
            justify-content: center;
        }

        .struk-container {
            width: 300px;
            color: black;
            font-family: Arial, sans-serif;
        }

        .border-box {
            border: 2px solid black;
            padding: 10px;
        }

        .modul-title { font-weight: 900; font-size: 14px; margin-bottom: 10px; text-transform: uppercase; }
        .header-center { text-align: center; margin-bottom: 8px; }
        .bukti-title { display: block; font-weight: 900; font-size: 18px; }
        .toko-name { font-weight: bold; font-size: 12px; }
        .info-row { display: flex; justify-content: space-between; font-size: 11px; margin-top: 5px; }
        .shift { text-align: center; font-size: 11px; margin: 5px 0; }
        .divider { border-top: 1px solid black; margin: 5px 0; }

        .data-table { width: 100%; font-size: 12px; border-collapse: collapse; }
        .text-right { text-align: right; }
        .bold { font-weight: bold; }

        @media print {
            .menu-input, .header-title { display: none; }
            body { background: white; padding: 0; }
            .struk-area { padding: 0; }
            .struk-container { width: 100%; }
        }
    </style>
</head>
<body>

<h1 class="header-title">Cetak SO Prodsus</h1>

<div class="menu-input">
    <div class="form-group">
        <label>Pilih SO Modul</label>
        <select id="inModul" onchange="hitungOtomatis()">
            <option value="24-FRIED CHICKEN">24-FRIED CHICKEN</option>
            <option value="7-HOT SAUSAGE">7-HOT SAUSAGE</option>
            <option value="22-BUAH LOKAL">22-BUAH LOKAL</option>
            <option value="2-SAYBREAD">2-SAYBREAD</option>
        </select>
    </div>

    <div class="form-group">
        <label>Tanggal (Otomatis dari HP)</label>
        <input type="text" id="inTgl" readonly style="background: #0a192f; color: #888;">
    </div>

    <div class="row-input">
        <div class="form-group">
            <label>Fisik QTY</label>
            <input type="number" id="inFisikQty" value="0" oninput="hitungOtomatis()">
        </div>
        <div class="form-group">
            <label>Fisik Rp (Auto)</label>
            <input type="text" id="inFisikRp" value="0" readonly>
        </div>
    </div>

    <div class="row-input">
        <div class="form-group">
            <label>LPP QTY</label>
            <input type="number" id="inLppQty" value="0" oninput="hitungOtomatis()">
        </div>
        <div class="form-group">
            <label>LPP Rp (Auto)</label>
            <input type="text" id="inLppRp" value="0" readonly>
        </div>
    </div>

    <div class="btn-group">
        <button class="btn btn-save" onclick="updateStruk()">Simpan Data</button>
        <button class="btn btn-print" onclick="window.print()">Cetak</button>
    </div>
</div>

<div class="struk-area">
    <div class="struk-container">
        <div class="border-box">
            <div class="modul-title" id="outModul">SO Modul: 24-FRIED CHICKEN</div>
            <div class="header-center">
                <span class="bukti-title">Bukti Adjust</span>
                <span class="toko-name">Toko: TAMAN PONDOK JATI</span>
            </div>
            <div class="info-row">
                <span id="outTgl">Tanggal : --/--/----</span>
                <span id="outJam">Jam : --:--:--</span>
            </div>
            <div class="shift">Shift 4</div>
            <div class="divider"></div>
            <div style="font-size:11px">Telah dilakukan Penyesuaian Stock:</div>
            <table class="data-table">
                <tr>
                    <td id="outFisikQty">Total Fisik SO: QTY: 0</td>
                    <td class="text-right" id="outFisikRp">Rp. 0</td>
                </tr>
                <tr>
                    <td id="outLppQty">Total LPP SO: QTY: 0</td>
                    <td class="text-right" id="outLppRp">Rp. 0</td>
                </tr>
            </table>
            <div class="divider"></div>
            <table class="data-table bold">
                <tr>
                    <td id="outSelisihQty">Selisih: QTY: 0</td>
                    <td class="text-right" id="outSelisihRp">Rp. 0</td>
                </tr>
            </table>
        </div>
    </div>
</div>

<script>
    const hargaMenu = {
        "24-FRIED CHICKEN": 12500,
        "7-HOT SAUSAGE": 13000,
        "22-BUAH LOKAL": 9000,
        "2-SAYBREAD": 12000
    };

    // Fungsi mendapatkan tanggal format HP (Bulan/Tanggal/Tahun)
    function getTanggalHP() {
        const skrg = new Date();
        const bulan = skrg.getMonth() + 1;
        const tgl = skrg.getDate();
        const thn = skrg.getFullYear();
        return `${bulan}/${tgl}/${thn}`;
    }

    window.onload = function() {
        const formatTgl = getTanggalHP();
        document.getElementById('inTgl').value = formatTgl;
        document.getElementById('outTgl').innerText = "Tanggal : " + formatTgl;
        hitungOtomatis();
    };

    function formatRupiah(angka) {
        return new Intl.NumberFormat('id-ID').format(angka);
    }

    function hitungOtomatis() {
        const menu = document.getElementById('inModul').value;
        const hargaSatuan = hargaMenu[menu];
        
        const fQty = parseInt(document.getElementById('inFisikQty').value) || 0;
        const lQty = parseInt(document.getElementById('inLppQty').value) || 0;

        const fTotal = fQty * hargaSatuan;
        const lTotal = lQty * hargaSatuan;

        document.getElementById('inFisikRp').value = formatRupiah(fTotal);
        document.getElementById('inLppRp').value = formatRupiah(lTotal);
    }

    function updateStruk() {
        const skrg = new Date();
        const jam = skrg.getHours().toString().padStart(2, '0') + ':' + 
                    skrg.getMinutes().toString().padStart(2, '0') + ':' + 
                    skrg.getSeconds().toString().padStart(2, '0');

        const menu = document.getElementById('inModul').value;
        const tglAktual = getTanggalHP(); // Ambil tanggal terbaru dari HP saat klik simpan
        const fQty = document.getElementById('inFisikQty').value;
        const fRp = document.getElementById('inFisikRp').value;
        const lQty = document.getElementById('inLppQty').value;
        const lRp = document.getElementById('inLppRp').value;

        // Hitung Selisih
        const sQty = fQty - lQty;
        const sRpVal = (fQty * hargaMenu[menu]) - (lQty * hargaMenu[menu]);

        // Update ke Tampilan Struk
        document.getElementById('outModul').innerText = "SO Modul: " + menu;
        document.getElementById('outTgl').innerText = "Tanggal : " + tglAktual;
        document.getElementById('outJam').innerText = "Jam : " + jam;
        document.getElementById('outFisikQty').innerText = "Total Fisik SO: QTY: " + fQty;
        document.getElementById('outFisikRp').innerText = "Rp. " + fRp;
        document.getElementById('outLppQty').innerText = "Total LPP SO: QTY: " + lQty;
        document.getElementById('outLppRp').innerText = "Rp. " + lRp;
        document.getElementById('outSelisihQty').innerText = "Selisih: QTY: " + sQty;
        document.getElementById('outSelisihRp').innerText = "Rp. " + formatRupiah(sRpVal);

        alert("Data struk berhasil disimpan dengan tanggal HP!");
    }
</script>

</body>
</html>
